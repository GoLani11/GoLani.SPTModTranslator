# GoLani SPT Mod Translator - 범용 모드 번역 시스템 구현 계획

## 🎯 목표
모든 BepInEx 플러그인 모드의 UI/텍스트를 JSON 설정만으로 빌드 없이 번역할 수 있는 범용적 시스템 구현

## 📋 구현 단계

### Phase 1: 핵심 인프라 구축

#### 1.1 범용 문자열 인터셉터 시스템
- [ ] `UniversalStringInterceptor.cs` 생성
  - [ ] Unity UI Text 컴포넌트 패치 (`UnityEngine.UI.Text.set_text`)
  - [ ] TextMeshPro 컴포넌트 패치 (`TMPro.TextMeshProUGUI.set_text`)
  - [ ] Legacy GUI 시스템 패치 (`UnityEngine.GUI.Label`, `GUILayout.Label`)
  - [ ] 패치 성능 최적화 (캐싱, 조건부 실행)

#### 1.2 모드 어셈블리 감지 시스템
- [ ] `ModAssemblyDetector.cs` 생성
  - [ ] 호출 스택 분석을 통한 모드 식별
  - [ ] BepInEx 플러그인 폴더 경로 기반 필터링
  - [ ] 어셈블리명/네임스페이스 패턴 매칭
  - [ ] 게임 기본 어셈블리 제외 리스트 관리

#### 1.3 동적 모드 매핑 시스템
- [ ] `ModMappingService.cs` 생성
  - [ ] 런타임 어셈블리 스캔
  - [ ] 모드 ID 자동 할당 알고리즘
  - [ ] 모드별 번역 파일 자동 연결
  - [ ] 충돌 감지 및 중복 제거

### Phase 2: 설정 시스템 확장

#### 2.1 범용 패치 설정
- [ ] `universal_patches.json` 생성
  - [ ] Unity UI 컴포넌트 대상 패치 정의
  - [ ] 성능 최적화 옵션 설정
  - [ ] 디버그 모드 설정

#### 2.2 모드 필터링 설정
- [ ] `mod_filter_config.json` 생성
  - [ ] 대상 모드 어셈블리 화이트리스트
  - [ ] 제외할 게임 기본 어셈블리 블랙리스트
  - [ ] 네임스페이스 패턴 규칙 정의
  - [ ] 우선순위 기반 모드 매칭 룰

#### 2.3 자동 감지 설정
- [ ] `auto_detection_config.json` 생성
  - [ ] 어셈블리 스캔 범위 설정
  - [ ] 모드 식별 패턴 정의
  - [ ] 번역 파일 자동 매핑 규칙

### Phase 3: 기존 시스템 통합

#### 3.1 PatchService 확장
- [ ] `PatchService.cs` 수정
  - [ ] 범용 패치 타입 추가: `UniversalStringInterceptor`
  - [ ] 동적 패치 적용/해제 메커니즘
  - [ ] 기존 패치 시스템과의 호환성 유지

#### 3.2 TranslationService 확장
- [ ] `TranslationService.cs` 수정
  - [ ] 모드 자동 감지 기반 번역 조회
  - [ ] 다중 모드 번역 충돌 해결
  - [ ] 캐시 시스템 최적화 (모드별 캐시)

#### 3.3 PatchDefinitionService 확장
- [ ] `PatchDefinitionService.cs` 수정
  - [ ] 범용 패치 정의 로드
  - [ ] 런타임 패치 정의 추가/제거
  - [ ] 설정 파일 실시간 감지 및 적용

### Phase 4: 스마트 번역 시스템

#### 4.1 컨텍스트 기반 번역
- [ ] `ContextualTranslator.cs` 생성
  - [ ] 호출 컨텍스트 분석 (UI 컴포넌트 계층구조)
  - [ ] 모드별 번역 우선순위 적용
  - [ ] 번역 품질 검증 시스템

#### 4.2 충돌 해결 시스템
- [ ] `TranslationConflictResolver.cs` 생성
  - [ ] 동일 텍스트의 다중 모드 번역 충돌 감지
  - [ ] 우선순위 기반 번역 선택
  - [ ] 사용자 정의 충돌 해결 규칙

#### 4.3 실시간 번역 적용
- [ ] 번역 파일 변경 감지 (FileSystemWatcher)
- [ ] 런타임 번역 리로드
- [ ] UI 즉시 반영 시스템

### Phase 5: 성능 최적화 및 디버깅

#### 5.1 성능 최적화
- [ ] 문자열 비교 최적화 (해시 기반)
- [ ] 번역 캐시 시스템 개선
- [ ] 불필요한 패치 호출 방지
- [ ] 메모리 사용량 최적화

#### 5.2 디버깅 도구
- [ ] `ModTranslationDebugger.cs` 생성
  - [ ] 실시간 번역 상태 모니터링
  - [ ] 모드별 번역 적용 통계
  - [ ] 번역 실패 원인 분석
  - [ ] 성능 프로파일링 도구

#### 5.3 로깅 시스템 개선
- [ ] 모드별 번역 로그 분리
- [ ] 번역 성공/실패 통계
- [ ] 성능 지표 로깅

### Phase 6: 사용자 경험 개선

#### 6.1 설정 UI 확장
- [ ] F12 메뉴에 범용 번역 설정 추가
- [ ] 모드별 번역 활성화/비활성화 토글
- [ ] 실시간 번역 테스트 기능

#### 6.2 자동 설정 생성
- [ ] 새 모드 감지 시 기본 설정 자동 생성
- [ ] 번역 파일 템플릿 자동 생성
- [ ] 사용자 가이드 자동 표시

#### 6.3 호환성 보장
- [ ] 기존 번역 설정 마이그레이션
- [ ] 하위 호환성 유지
- [ ] 업데이트 시 설정 보존

## 🔧 기술적 고려사항

### 성능
- 문자열 패치는 게임 성능에 직접적 영향을 미치므로 최적화 필수
- 캐시 시스템을 통한 중복 번역 방지
- 조건부 패치 실행으로 불필요한 오버헤드 최소화

### 안정성
- 게임 기본 UI에 영향을 주지 않도록 엄격한 필터링
- 예외 처리를 통한 안정성 확보
- 패치 실패 시 기본 동작 보장

### 확장성
- 새로운 모드 추가 시 최소한의 설정으로 지원
- 플러그인 아키텍처를 통한 기능 확장
- 버전 업데이트 시 설정 호환성 유지

## 📅 우선순위

**높음 (즉시 구현)**
- Phase 1: 핵심 인프라 구축
- Phase 2.1: 범용 패치 설정

**중간 (단계적 구현)**
- Phase 2.2-2.3: 설정 시스템 확장
- Phase 3: 기존 시스템 통합

**낮음 (장기적 개선)**
- Phase 4-6: 고급 기능 및 사용자 경험

## 🎯 성공 지표

- [ ] 새로운 모드 추가 시 번역 파일만으로 즉시 적용 가능
- [ ] 게임 기본 UI는 절대 번역되지 않음
- [ ] 성능 오버헤드 5% 이하 유지
- [ ] 모든 Unity UI 컴포넌트에서 번역 작동
- [ ] JSON 파일 수정 후 재시작 없이 즉시 반영